# CO2 Sensor

## Purchase

- Rasbperry Pi
- CO2 Sensor Module

## Circuit

For the mh-z19 sensor, [a python module](https://pypi.org/project/mh-z19/) is available.
![mh-z19 circuit](https://warehouse-camo.ingress.cmh1.psfhosted.org/5e69358ea376cf9c8460b74610e3cd2ca2f487f9/68747470733a2f2f63616d6f2e67697468756275736572636f6e74656e742e636f6d2f336364346331623438326561393032623765363664636131336434323630313933633833316136332f3638373437343730373333613266326636333631366436663265373136393639373436313735373336353732363336663665373436353665373432653633366636643266333133313332363136343335363636353334333136333338333236313331333633363337333136343332333833383332333033373330333333383334333133303339363333383338333633303633363332663336333833373334333733343337333033373333333336313332363633323636333733313336333933363339333733343336333133323634333633393336363433363331333633373336333533323634333733333337333433363636333733323336333533323635333733333333333333323635333633313336363433363331333736313336363633363635333633313337333733373333333236353336333333363636333636343332363633333330333236363333333433333336333333353333333433333334333236363333333033333338333333323333333833333333333333303333333133333334333236343333333633333338333633343333333233323634333633333333333333363334333633353332363433333331333333363333333433333334333236343333333733363333333333383336333433333339333633323333333733363332333333363333333233363336333633343332363533363631333733303336333533363337)

## Script

### Requirements

- Python3.9+
- Prometheus Push Gateway

  - local

    ```bash
    docker run -d -p 9091:9091 prom/pushgateway
    ```

  - Remote

    - Set Environment

    ```bash
    export PUSHGATEWAY_ADDRESS = "localhost:9091"
    ```

### Installation

```
python -m venv venv
. venv/bin/activate
pip install -r requirements.txt
```

Install systemd
```
# Edit installation location and other information
vi co2-sensor.service

sudo cp co2-sensor.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable co2-sensor
sudo systemctl start co2-sensor
```

Edit environment variables for systemd
```
sudo mkdir -p /etc/systemd/system/co2-sensor.service.d

# copy conf for dev
sudo cp -r override.dev.conf /etc/systemd/system/co2-sensor.service.d/override.conf

# Edit directly conf
# sudo systemctl edit co2-sensor

sudo systemctl daemon-reload
sudo systemctl restart co2-sensor
```

### Usage

Run

```
sudo python main.py
```
